---
# tasks file for rhel-patching-pre-tasks

- name: Running RHEL Upgrade Pre-Tasks 
  debug:
    msg: "Backup config and snapshots"

# follow tasks for snapshots and backups as needed

- name: Get Service Facts
  service_facts:

- name: "Check Service List Status"
  debug:
    var: ansible_facts.services

- name: "Check Services and Set Status"
  debug:
    msg: "{{ item[0] }}"
  #set_facts:
  #  any_service_running: true
  when: item[1] in item[0]
  with_nested: 
    - "{{ ansible_facts.services }}"
    - "{{ service_list }}"


- name: "Some listed services still running. Do you want to continue patching ?"
  pause:
    prompt: Please confirm you want to continue patching. Press return to continue. Press Ctrl+c and then "a" to abort
  when: any_service_running

- name: Backup configuration files
  debug:
    msg: "Taking backup of /etc/fstab, /etc/passwd"

- name: Initiating Snapshot
  debug:
    msg: "Calling Snapshot job"    
